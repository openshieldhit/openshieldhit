
#include <stdint.h>

int const _nmat = 24; /* number of materials (or segmentations) */
int const _nelm = 14; /* number of elements */

/* list of elment z values for each element */
float const _ct_elmz[14] = {
    /*  H, C, N, O, Na, Mg,  P,  S, Cl, Ar,  K, Ca */
    1,
    6,
    7,
    8,
    11,
    12,
    15,
    16,
    17,
    18,
    19,
    20};

/* average densities */
float const _ct_hu_rho[24] = {
    0.00121, // [-1000.. -950]  1. air..adipose fit (air)
    0.46906, // [ -950.. -120]  2. air..adipose fit (midpoint)
    0.93000, // [ -120..  -83]  3. air..adipose fit (adipose)
    0.95728, // [  -83..  -53]  4. eq (21)
    0.98451, // [  -52..  -23]  5. eq (21)
    1.01130, // [  -22..    7]  6. eq (21)
    1.03000, // [    8..   18]  7. value 1.03
    1.06086, // [   19..   80]  8. eq (23)
    1.07620, // [   80..  120]  9. eq (19)
    1.11172, // [  120..  200] 10. eq (19)
    1.16500, // [  200..  300] 11. eq (19)
    1.22420, // [  300..  400] 12. eq (19)
    1.28340, // [  400..  500] 13. eq (19)
    1.34260, // [  500..  600] 14. eq (19)
    1.40180, // [  600..  700] 15. eq (19)
    1.46100, // [  700..  800] 16. eq (19)
    1.52020, // [  800..  900] 17. eq (19)
    1.57940, // [  900.. 1000] 18. eq (19)
    1.63860, // [ 1000.. 1100] 19. eq (19)
    1.69780, // [ 1100.. 1200] 20. eq (19)
    1.75700, // [ 1200.. 1300] 21. eq (19)
    1.81620, // [ 1300.. 1400] 22. eq (19)
    1.87540, // [ 1400.. 1500] 23. eq (19)
    1.93460  // [ 1500.. 1600] 24. eq (19)
};

/* lower and upper HU levels */ // TODO check references, [a,b[ ?
// float const _ct_hu[24][2] = {
//     {-1000, -950},
//     {-950, -120},
//     {-120, -83},
//     {-82, -53},
//     {-52, -23},
//
//     {-22, 7},
//     {8, 18},
//     {19, 80},
//     {80, 120},
//     {120, 200},
//
//     {200, 300},
//     {300, 400},
//     {400, 500},
//     {500, 600},
//     {600, 700},
//
//     {700, 800},
//     {800, 900},
//     {900, 1000},
//     {1000, 1100},
//     {1100, 1200},
//     {1200, 1300},
//     {1300, 1400},
//     {1400, 1500},
//     {1500, 1600},
// };

/* lower bin limits, binary search compatible */
int16_t const _ct_hu[25] = {
    -1000, -950, -120, -82, -52, -22,  8,    19,   80,   120,  200,  300, 400,
    500,   600,  700,  800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600 /* <- upper bin */
};

/* relative elemental composition */
float const _ct_relm[24][14] = {{0.0, 0.0, 75.5, 23.2, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3, 0.0, 0.0},
                                {10.3, 10.5, 3.10, 74.9, 0.2, 0.0, 0.2, 0.3, 0.3, 0.0, 0.2, 0.0},
                                {11.6, 68.1, 0.30, 19.8, 0.10, 0.0, 0.0, 0.1, 0.1, 0.0, 0.0, 0.0},
                                {11.3, 56.7, 0.90, 30.8, 0.10, 0.0, 0.0, 0.1, 0.1, 0.0, 0.0, 0.0},
                                {11.0, 45.8, 1.50, 41.1, 0.10, 0.0, 0.1, 0.2, 0.2, 0.0, 0.0, 0.0},

                                {10.8, 35.6, 2.20, 50.9, 0.0, 0.0, 0.1, 0.2, 0.2, 0.0, 0.0, 0.0},
                                {10.6, 28.4, 2.6, 57.8, 0.0, 0.0, 0.1, 0.2, 0.2, 0.0, 0.1, 0.0},
                                {10.3, 13.4, 3.0, 72.3, 0.2, 0.0, 0.2, 0.2, 0.2, 0.0, 0.2, 0.0},
                                {9.4, 20.7, 6.2, 62.2, 0.6, 0.0, 0.0, 0.6, 0.3, 0.0, 0.0, 0.0},
                                {9.5, 45.5, 2.5, 35.5, 0.1, 0.0, 2.1, 0.1, 0.1, 0.0, 0.1, 4.5},

                                {8.9, 42.3, 2.7, 36.3, 0.1, 0.0, 3.0, 0.1, 0.1, 0.0, 0.1, 6.4},
                                {8.2, 39.1, 2.9, 37.2, 0.1, 0.0, 3.9, 0.1, 0.1, 0.0, 0.1, 8.3},
                                {7.6, 36.1, 3.0, 38.0, 0.1, 0.1, 4.7, 0.2, 0.1, 0.0, 0.0, 10.1},
                                {7.1, 33.5, 3.2, 38.7, 0.1, 0.1, 5.4, 0.2, 0.0, 0.0, 0.0, 11.7},
                                {6.6, 31.0, 3.3, 39.4, 0.1, 0.1, 6.1, 0.2, 0.0, 0.0, 0.0, 13.2},

                                {6.1, 28.7, 3.5, 40.0, 0.1, 0.1, 6.7, 0.2, 0.0, 0.0, 0.0, 14.6},
                                {5.6, 26.5, 3.6, 40.5, 0.1, 0.2, 7.3, 0.3, 0.0, 0.0, 0.0, 15.9},
                                {5.2, 24.6, 3.7, 41.1, 0.1, 0.2, 7.8, 0.3, 0.0, 0.0, 0.0, 17.0},
                                {4.9, 22.7, 3.8, 41.6, 0.1, 0.2, 8.3, 0.3, 0.0, 0.0, 0.0, 18.1},
                                {4.5, 21.0, 3.9, 42.0, 0.1, 0.2, 8.8, 0.3, 0.0, 0.0, 0.0, 19.2},

                                {4.2, 19.4, 4.0, 42.5, 0.1, 0.2, 9.2, 0.3, 0.0, 0.0, 0.0, 20.1},
                                {3.9, 17.9, 4.1, 42.9, 0.1, 0.2, 9.6, 0.3, 0.0, 0.0, 0.0, 21.0},
                                {3.6, 16.5, 4.2, 43.2, 0.1, 0.2, 10.0, 0.3, 0.0, 0.0, 0.0, 21.9},
                                {3.4, 15.5, 4.2, 43.5, 0.1, 0.2, 10.3, 0.3, 0.0, 0.0, 0.0, 22.5}};
